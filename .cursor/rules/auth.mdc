---
description: 
globs: 
alwaysApply: true
---
# Auth

- Use better-auth for authentication

## Authorization

- The auth-client is used to perform actions such as client side authorization, sign in, or sign out. The auth-client is located at [auth-client.ts](mdc:src/lib/auth/auth-client.ts).
- Client side authorization:

  ```typescript
  import { authClient } from "@/lib/auth-client";

  export function User(){
    const { data: session } = authClient.useSession()

    return (
        //...
    )
  }
  ```

- The better-auth instance is used for server side authorization. The better-auth instance is located at [index.ts](mdc:src/lib/auth/index.ts).
- Server side authorization:

  ```typescript
  import { headers } from "next/headers";
  import { redirect } from "next/navigation";

  import { auth } from "@/lib/auth";

  export function MealPlanPage(){
    const session = await auth.api.getSession({
      headers: await headers(),
    });

    if (!session) {
      redirect("/auth/sign-in");
    }

      if (!session.user.onboardingComplete) {
        return redirect("/onboarding");
      }

    return (
        //...
    )
  }
  ```
